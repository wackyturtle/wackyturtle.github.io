---
layout: single
title: "스파르타 내일배움 캠프 58일차 TIL"
date: 2025-08-13 19:00:00 +0900
categories: [TIL, all]
classes: wide
sidebar:
    nav: "counts"
---
<br><br>
# Flutter/Dart enum 완벽 가이드

## 1) enum이란?
- **열거형**: 유한하고 고정된 값들의 집합을 “타입”으로 선언.  
- **타입 안정성 & 가독성**: `String`이나 `int` 대신 의미 있는 이름을 갖는 값으로 코드 안정·가독성↑
- **폐쇄된 집합**: 값 추가/변경이 컴파일 타임에 강하게 드러남(스위치 누락 경고 등).

```dart
enum AuthState { unauthenticated, authenticating, authenticated, error }
```

---

## 2) 기본 문법 & 생성
- 값들은 콤마로 구분, 끝에 세미콜론 필요 없음(멤버를 추가할 땐 세미콜론 필요).
- 이름 규칙: **타입명은 PascalCase**, **값은 lowerCamelCase**가 관례.

```dart
enum ColorKind { red, green, blue }
```

---

## 3) 구동 원리(내부 동작)
- 각 enum 값은 **컴파일 타임에 생성된 상수(singleton) 객체**.
- 비교는 **참조 동일성**(==가 빠르고 안전함). `identical(ColorKind.red, ColorKind.red) == true`.
- 선언 순서대로 0부터 **index**가 부여되며, enum 타입별로 **정적 리스트 `values`**가 자동 생성됨.
- 모든 enum은 암묵적으로 **`Enum`**을 상속(내장 베이스 클래스). 여기에 `index`, `name`, `toString()` 등이 정의됨.
- 런타임에 값을 추가/삭제할 수 없음(폐쇄적).

---

## 4) 기본 제공 속성/유틸
```dart
final c = ColorKind.green;

c.index;                      // 1 (0부터 시작)
c.name;                       // 'green' (값의 원래 이름)
c.toString();                 // 'ColorKind.green' (로그용)
ColorKind.values;             // [ColorKind.red, ColorKind.green, ColorKind.blue]
ColorKind.values.byName('red');    // ColorKind.red (이름→값 찾기)
ColorKind.values.asNameMap();      // {'red': ColorKind.red, ...}
```
**TIP**: 저장/전송엔 `index`보다 `name`을 권장(순서 바뀌면 index 깨짐).

---

## 5) switch/패턴 매칭(완전범위 체크)
```dart
String label(ColorKind c) => switch (c) {
  ColorKind.red   => '빨강',
  ColorKind.green => '초록',
  ColorKind.blue  => '파랑',
};
```

---

## 6) Flutter에서 실전 사용
### (1) 위젯 속성 매핑
```dart
Color toColor(ColorKind c) => switch (c) {
  ColorKind.red   => const Color(0xFFE53935),
  ColorKind.green => const Color(0xFF43A047),
  ColorKind.blue  => const Color(0xFF1E88E5),
};
```

### (2) Dropdown과 연동
```dart
DropdownButton<ColorKind>(
  value: ColorKind.red,
  items: ColorKind.values.map((e) {
    return DropdownMenuItem(
      value: e,
      child: Text(e.name),
    );
  }).toList(),
  onChanged: (v) { /* 상태 갱신 */ },
);
```

### (3) Riverpod/상태관리와 함께
```dart
final colorProvider = StateProvider<ColorKind>((_) => ColorKind.green);

// UI
final c = ref.watch(colorProvider);
Container(color: toColor(c));
```

---

## 7) Enhanced Enums(강화된 enum)
```dart
enum TicketStatus implements Comparable<TicketStatus> {
  newOne('새 티켓', Icons.fiber_new, Colors.blue),
  assigned('배정됨', Icons.assignment_ind, Colors.orange),
  resolved('해결', Icons.check_circle, Colors.green),
  closed('종료', Icons.cancel, Colors.grey);

  final String label;
  final IconData icon;
  final Color color;

  const TicketStatus(this.label, this.icon, this.color);

  bool get isFinal => this == resolved || this == closed;

  @override
  int compareTo(TicketStatus other) => index.compareTo(other.index);
}
```

---

## 8) Extension으로 기능 더하기
```dart
extension TicketStatusX on TicketStatus {
  String get short => switch (this) {
    TicketStatus.newOne   => 'NEW',
    TicketStatus.assigned => 'ASG',
    TicketStatus.resolved => 'OK',
    TicketStatus.closed   => 'END',
  };

  static TicketStatus? tryParse(String raw) {
    return TicketStatus.values.asNameMap()[raw];
  }

  Widget chip() => Chip(
    avatar: Icon(icon, size: 16),
    label: Text(label),
    backgroundColor: color.withOpacity(0.12),
  );
}
```

---

## 9) JSON 직렬화/역직렬화
```dart
Map<String, dynamic> toJson(TicketStatus s) => {'status': s.name};

TicketStatus fromJson(Map<String, dynamic> json) =>
  TicketStatus.values.byName(json['status'] as String);
```

---

## 10) 집합·여러 선택
```dart
final selected = <ColorKind>{ColorKind.red, ColorKind.blue};
selected.contains(ColorKind.green); // false
```

---

## 11) 정렬/매핑
```dart
final map = <TicketStatus, String>{
  TicketStatus.newOne: 'N',
  TicketStatus.assigned: 'A',
  TicketStatus.resolved: 'R',
  TicketStatus.closed: 'C',
};
```

---

## 12) 흔한 실수 & 베스트 프랙티스
1. `index`로 저장하지 말기 → 순서 바뀌면 망가짐. `name` 사용.
2. switch에서 `default` 남발 금지 → 케이스 누락을 컴파일러가 잡지 못함.
3. 문자열 표시엔 `toString()`보다 `name` 사용.
4. UI 매핑은 enum이 책임지게.
5. 로컬라이즈 라벨은 l10n 키로 매핑.

---

## 13) 미니 실전 예시
```dart
enum OrderState {
  pending('대기', Icons.timelapse, Colors.amber),
  paid('결제완료', Icons.payments, Colors.green),
  shipped('배송중', Icons.local_shipping, Colors.blue),
  delivered('배송완료', Icons.check_circle, Colors.teal),
  canceled('취소', Icons.cancel, Colors.red);

  final String label;
  final IconData icon;
  final Color color;

  const OrderState(this.label, this.icon, this.color);

  bool get isTerminal => this == delivered || this == canceled;
}

extension OrderStateUI on OrderState {
  Widget pill() => Container(
    padding: const EdgeInsets.symmetric(horizontal: 10, vertical: 6),
    decoration: BoxDecoration(
      color: color.withOpacity(0.12),
      borderRadius: BorderRadius.circular(999),
      border: Border.all(color: color.withOpacity(0.5)),
    ),
    child: Row(mainAxisSize: MainAxisSize.min, children: [
      Icon(icon, size: 14),
      const SizedBox(width: 6),
      Text(label),
    ]),
  );
}
```

---

## 요약
- enum은 **유한한 상태를 타입으로 안전하게 표현**하는 도구.
- Enhanced enum으로 필드/메서드/인터페이스 구현 가능.
- Flutter에서 UI 매핑, 상태관리, 폼 옵션 등에 최적.
- JSON엔 `name` 저장, switch는 완전 열거, 로직은 enum/extension에 응집.
